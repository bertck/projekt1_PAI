extends ../layout

block content
    .form-container
        h1 Edytuj rezerwację
        form(action=`/reservations/${reservation.id}`, method='post')
            input(type='hidden' name='_method' value='PUT')
            label(for='machineId') Maszyna (wymagane)
            select(name='machineId' id='machineId', required)
                each machine in machines
                    option(value=machine.id, selected=(machine.id == reservation.machineId))= machine.name
            label(for='startDate') Od (max 3 mies. wprzód)
            input(type='date' name='startDate' id='startDate', required, value=reservation.startDate)
            label(for='endDate') Do (max 3 mies. wprzód)
            input(type='date' name='endDate' id='endDate', required, value=reservation.endDate)
            button.btn(type='submit') Zapisz
        script.
            const startInput = document.getElementById('startDate');
            const endInput = document.getElementById('endDate');
            const max = new Date();
            max.setMonth(max.getMonth() + 3);
            const maxStr = max.toISOString().split('T')[0];
            startInput.max = maxStr;
            endInput.max = maxStr;
            document.querySelector('form').addEventListener('submit', e => {
                const s = new Date(startInput.value);
                const en = new Date(endInput.value);
                if (s > en || s > max || en > max) {
                    e.preventDefault();
                    alert('Nieprawidłowe daty: początek po końcu lub poza zakresem 3 miesięcy');
                }
            });
    a.btn(href='/reservations') Wróć do listy rezerwacji